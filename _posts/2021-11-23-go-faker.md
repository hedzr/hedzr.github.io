---
layout: single
title: 'go-faker: ä¸€ä¸ª mock æ•°æ®ç”Ÿæˆå™¨'
date: 2021-11-23 05:07:11 +0800
last_modified_at: 2021-11-23 07:29:11 +0800
Author: hedzr
tags: [golang, testing, mock]
categories: golang testing
comments: true
toc: true
header:
  teaser: https://raw.githubusercontent.com/hzimg/blog-pics/master/uPic/image-20211124171924502.png
  overlay_image: /assets/images/unsplash-image-1.jpg
  overlay_filter: rgba(128, 128, 0, 0.3)
excerpt: >-
  go-faker æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ç”¨äºç”Ÿæˆå„ç§ mock æ•°æ® ...
---



## go-faker



[go-faker](https://github.com/hedzr/go-faker) èƒ½å¤Ÿç”Ÿæˆå„ç±» mock æ•°æ®ï¼Œå¾ˆé€‚åˆç”¨åœ¨æµ‹è¯•åœºæ™¯ä¸­ã€‚

ä¾‹å¦‚å½“ä½ éœ€è¦ä¸€ä¸ªè™šå‡çš„ç”¨æˆ·è®°å½•ä»¥ä¾¿å®ŒæˆæŸç§æ³¨å†Œæµç¨‹å•å…ƒæµ‹è¯•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```bash
> docker run -it --rm hedzr/faker internet
{"Internet":{"DomainName":"ziemann.net","DomainSuffix":"com","DomainWord":"green","Email":"garry@hintz.biz","FreeEmail":"christian@yahoo.com","IpV4Address":"48.107.223.211","IpV6Address":"bc8e:e770:c962:4004:8045:86e2:2658:bfc7","MacAddress":"52:6b:0d:24:7d:67","Password":"Za9pR1hfV7yJXw3Mhf9I5EvL1uvo0M","SafeEmail":"sheridan.gibson@example.net","Slug":"adipisci-inventore","Url":"http://roobroberts.name/americo.lindgren","UserName":"lenny.trantow"}}
```

è¿™æ ·ï¼Œä½ å°±å¯ä»¥å¾—åˆ°ä¸€æ¡ç”¨æˆ·è®°å½•ï¼Œå­—æ®µæœ‰é™ä½†å·®ä¸å¤šå¤Ÿç”¨ã€‚

### å®‰è£…

é‡‡ç”¨ docker è¿è¡Œçš„æ–¹å¼å¯ä»¥ç«‹å³è¿è¡Œï¼Œåªè¦ä½ èƒ½å¤Ÿé¡ºåˆ©æ‹‰å– docker hub çš„é•œåƒå³å¯ã€‚

```bash
docker pull hedzr/faker
```

å¦‚æœä½ æ›´æ„¿æ„ä» GitHub çš„ Registry æ‹‰å–é•œåƒï¼Œä¹Ÿè¡Œï¼š

```bash
docker pull ghcr.io/hedzr/cli/faker
```

å¦‚æœä½ åœ¨ä½¿ç”¨ macOS ç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡ Homebrew çš„æ–¹å¼å®‰è£…ï¼š

```bash
brew tap hedzr/brew
brew install faker
# æˆ–è€…ç›´æ¥ï¼š
brew install hedzr/brew/faker

# ç„¶å
faker --help
...
```

> ä½†å¯èƒ½ä¸èƒ½æ”¯æŒ M1 ç¯å¢ƒã€‚

å¦‚æœæ˜¯å…¶å®ƒ OS ç¯å¢ƒï¼Œè¯·é€šè¿‡ [Releases](https://github.com/hedzr/go-faker/releases) é¡µé¢ä¸‹è½½é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶åŒ…ã€‚

å¦‚æœæ²¡æœ‰é¢„å…ˆç¼–è¯‘çš„äºŒè¿›åˆ¶åŒ…çš„è¯ï¼Œä½ åªèƒ½é€šè¿‡ç¼–è¯‘æºç çš„æ–¹å¼æ¥è·å¾—ä½ çš„å¯æ‰§è¡Œæ–‡ä»¶äº†ï¼Œè¿™éœ€è¦ä½ å®‰è£…äº† golang ç¼–è¯‘ç¯å¢ƒï¼š

```bash
go install github.com/hedzr/go-faker
```

ä¸Šé¢çš„åŠæ³•æ€»æœ‰é€‚åˆä½ çš„ã€‚



### èƒŒæ™¯

[go-faker](https://github.com/hedzr/go-faker) æ˜¯é€šè¿‡  [dmgk/faker](https://github.com/dmgk/faker) æ¥å®ç°çš„ã€‚æˆ‘ä»¬ç‰ˆæœ¬ä»…ä»…åªæ˜¯ä¸€ä¸ªæœ‰æ°å½“å¤–åŒ…è£…çš„å¯æ‰§è¡Œæ–‡ä»¶å¤–å£³ã€‚

go-faker ç›®å‰æ”¯æŒå‡ ä¹æ‰€æœ‰çš„ [dmgk/faker](https://github.com/dmgk/faker) æ•°æ®ï¼Œé™¤äº†æ—¥æœŸå’Œæ—¶é—´ï¼Œè¿™ä¸¤ä¸ªæ•°æ®çš„ mock é‡‡ç”¨ OS è‡ªå¸¦çš„ date å‘½ä»¤æ›´ä¸ºç®€ä¾¿ã€‚

å¯ç”¨çš„ go-faker å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
> faker -h
```

![image-20211124171924502](https://raw.githubusercontent.com/hzimg/blog-pics/master/uPic/image-20211124171924502.png)

ä½¿ç”¨æ—¶å¯ä»¥æ˜¯è¿™æ ·ï¼š

```bash
> faker addr
{"Address":{"BuildingNumber":788,"City":"East Geraldineside","CityPrefix":"North","CitySuffix":"land","Country":"Costa Rica","CountryCode":"BG","Latitude":82.16658,"Longitude":-89.001114,"Postcode":"95690-3954","PostcodeByState":64204,"SecondaryAddress":"Apt. 211","State":"Rhode Island","StateAbbr":"OR","StreetAddress":"10067 Jimmy Forge","StreetName":"Gleichner Vista","StreetSuffix":"Shoals","String":"95126 Kamren Haven Apt. 514, Port Joannyburgh Utah 96447","TimeZone":"Africa/Cairo","ZipCode":"58451-9050","ZipCodeByState":38836}}
```

ä¹Ÿå¯ä»¥äº§å‡º yaml æ ¼å¼ç­‰ç­‰ã€‚



### å‘½ä»¤è¡Œå‚æ•°

æ°å½“çš„å¤–åŒ…è£…æ˜¯æŒ‡æˆ‘ä»¬æœ‰ä¸€å¥—ç¬¦åˆç›´è§‰ä¹ æƒ¯ï¼Œç¬¦åˆ POSIX æƒ¯ä¾‹çš„å‘½ä»¤è¡Œå‚æ•°ä¾›ç»™æ–¹å¼ã€‚

ä»¥ä¿¡ç”¨å¡å·ç ä¸ºä¾‹ï¼Œå¯ä»¥è¿™æ ·ï¼š

```bash
â¯ ./bin/faker_darwin-amd64 f --visa --plain # shortcut to 'finance'
        visa : 4364442188476

â¯ ./bin/faker_darwin-amd64 finance -m
    mastercard : 6771-8918-3284-3326

â¯ ./bin/faker_darwin-amd64 finance --mastercard
{ "finance": { "mastercard": "5150-3577-9332-4378" } }

â¯ ./bin/faker_darwin-amd64 finance --mastercard -yaml
finance:
  mastercard: 5480-4039-7556-4612

â¯ ./bin/faker_darwin-amd64 finance --mastercard --json
{
  "finance": {
    "mastercard": "6771-8948-9019-6694"
  }
}
```

ä½ å¯ä»¥é€‰æ‹©æ‰€éœ€çš„è¾“å‡ºæ ¼å¼ï¼Œjson æˆ–è€… json-compactï¼Œåˆæˆ–è€… yaml æ ¼å¼ã€‚

å¯¹äº finance å‘½ä»¤æ¥è¯´ï¼Œå¯ä»¥äº§å‡ºçš„ä¿¡ç”¨å¡å·ç æ ¼å¼å¦‚ä¸‹ï¼Œ

![image-20211124172205036](https://raw.githubusercontent.com/hzimg/blog-pics/master/uPic/image-20211124172205036.png)

è¯·è‡ªè¡ŒæŠ‰æ‹©ã€‚

å…¶å®ƒçš„ faked è®°å½•é‡‡ç”¨ç›¸åŒçš„æ–¹å¼ï¼Œæ‰€ä»¥è¿™é‡Œä¸å†ç½—åˆ—äº†ã€‚

ä½ å¯ä»¥åˆ†åˆ«æ£€è§† [go-faker](https://github.com/hedzr/go-faker) å’Œ  [dmgk/faker](https://github.com/dmgk/faker) çš„ä¸»é¡µæ¥è·çŸ¥æ›´å¤šä¿¡æ¯ã€‚



## åè®°

æ—©å‰æœ‰ä¸€æ¬¡éšæ„æµè§ˆæ—¶å‘ç°äº† [dmgk/faker](https://github.com/dmgk/faker) è¿™ä¸ªåº“ï¼Œä¸è¿‡å®ƒè¦æ±‚æˆ‘ä»¥ç¼–ç¨‹æ–¹å¼æ¥å–å¾— mock è®°å½•ï¼Œæ‰€ä»¥æœ‰å¤©æ™šä¸Šå¹²è„†å°±å¼„äº†ä¸ª CLI å£³ï¼Œç”¨ä½œ curl çš„ json è¾“å…¥å¾ˆä¾¿åˆ©ã€‚

ç„¶ååˆæƒ³åˆ°å··å­å¤ªæ·±ï¼Œäºæ˜¯é…ä¸€ç¯‡æ–‡ç« ä»‹ç»å§ï¼Œä¹Ÿè®¸æœ‰äººç”¨å¾—ä¸Šå‘¢ã€‚



### II

æœˆåˆç”±äºç‰¹åˆ«åŸå› ï¼Œç‰‡åŒºæ¥è¿‘å°é”ï¼Œå…¨å‘˜æ ¸é…¸ï¼Œæˆ‘ä»¬éƒ½åœ¨å°å¿ƒå’Œæ”¾è‚†ä¹‹é—´æŒ¨æ—¶é—´ã€‚åæ¥å¤§å®¶éƒ½å®‰å…¨äº†ã€‚ä½†å¼•å‘çš„æ€è€ƒå°±ä¸åœæ­‡ï¼šå³ä½¿æˆ‘å†æ€ä¹ˆå°å¿ƒç¿¼ç¿¼ï¼Œä¹ŸæŠµæŒ¡ä¸äº†è«åå…¶å¦™è€Œæ¥çš„æ—¶ç©ºé‡å æ‰€å¸¦æ¥çš„åæœï¼Œæ‰€ä»¥ï¼Œæ€ä¹ˆåŠå‘¢ã€‚

ä½†æ˜¯ï¼Œç°åœ¨åˆå·²ç»å›åˆ°äº†æ”¾è‚†çš„æ°›å›´äº†ã€‚

è¿˜æ˜¯ç»§ç»­æ›´æ–°è¿™é‡Œå§ï¼Œåªè¦èšç„¦åœ¨ä»£ç ä¹‹ä¸­ï¼Œæƒ³ä¸é€šçš„äº‹æƒ…è‡ªç„¶å¯ä»¥ä¸å¿…æƒ³ã€‚





ğŸ”š